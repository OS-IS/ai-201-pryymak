### Тестування для підробки міжсайтових запитів

**Резюме**  
Cross-Site Request Forgery (CSRF) — це атака, яка змушує кінцевого користувача виконувати непередбачені дії на веб-застосунку, в якому він зараз аутентифікований. За допомогою трохи соціальної інженерії (наприклад, відправлення посилання через електронну пошту або чат) зловмисник може змусити користувачів веб-застосунку виконувати дії, які вибрав він сам. Успішна експлуатація CSRF може скомпрометувати дані користувача та операції, коли атака націлена на звичайного користувача. Якщо кінцевим користувачем є обліковий запис адміністратора, атака CSRF може скомпрометувати весь веб-застосунок.

CSRF залежить від:

1. Поведінки веб-браузера щодо обробки інформації, пов'язаної з сесією, такої як куки та HTTP-автентифікація.
2. Знання зловмисником дійсних URL-адрес веб-застосунку, запитів або функціональності.
3. Управління сесією застосунку, яке покладається тільки на інформацію, відому браузеру.
4. Наявності HTML-тегів, присутність яких викликає негайний доступ до HTTP[S] ресурсу; наприклад, тег зображення img.

Пункти 1, 2 і 3 є необхідними для наявності вразливості, тоді як пункт 4 полегшує фактичну експлуатацію, але не є суворо необхідним.

Браузери автоматично відправляють інформацію, яка використовується для ідентифікації сесії користувача. Припустимо, сайт є сайтом, що хостить веб-застосунок, і користувач-жертва щойно аутентифікувався на сайті. У відповідь сайт відправляє жертві куки, що ідентифікують запити, надіслані жертвою, як частину її аутентифікованої сесії. Як тільки браузер отримує куки, встановлені сайтом, він автоматично відправляє їх разом з будь-якими подальшими запитами, спрямованими на сайт.  
Якщо застосунок не використовує інформацію, пов'язану з сесією, в URL-адресах, то URL-адреси застосунку, їхні параметри та дійсні значення можуть бути ідентифіковані. Це може бути здійснено через аналіз коду або доступ до застосунку та запис форм і URL-адрес, вбудованих у HTML або JavaScript.  
"Відомо браузеру" стосується такої інформації, як куки або HTTP-автентифікація (наприклад, Basic Authentication, а не автентифікація на основі форм), яка зберігається в браузері і після цього присутня на кожному запиті, спрямованому до області застосунку, яка вимагає такої автентифікації. Наступні обговорення вразливостей стосуються застосунків, які повністю покладаються на такого роду інформацію для ідентифікації сесії користувача.

Для спрощення розглянемо URL-адреси, доступні через GET (хоча обговорення стосується також POST-запитів). Якщо жертва вже аутентифікована, подання ще одного запиту автоматично відправить куки разом з ним. На малюнку нижче показано, як користувач отримує доступ до застосунку на www.example.com.

https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/images/Session_riding.GIF![image](https://github.com/user-attachments/assets/a2dbc7da-4c5b-4c50-a404-b7f03110c6fd)
